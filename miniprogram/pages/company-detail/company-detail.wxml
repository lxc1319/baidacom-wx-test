<!-- ç‰©æµå…¬å¸è¯¦æƒ…é¡µ -->
<view class="company-detail-page">
  <!-- é¡¶éƒ¨è½®æ’­å›¾åŒºåŸŸ -->
  <view class="banner-section" wx:if="{{banners.length > 0}}">
    <banner-swiper
      banners="{{banners}}"
      indicatorType="bar"
      bind:bannerClick="onBannerClick"
    />
  </view>

  <!-- æ¶ˆæ¯é€šå‘Šæ  -->
  <view class="notice-section" bindtap="onNoticeClick">
    <view class="notice-content">
      <view class="notice-icon">
        <text class="icon-notice">ğŸ“¢</text>
      </view>
      <swiper class="notice-swiper" vertical autoplay circular interval="3000" wx:if="{{noticeList.length > 0}}">
        <swiper-item class="notice-item" wx:for="{{noticeList}}" wx:key="id">
          <text class="notice-text">{{item.title}}</text>
        </swiper-item>
      </swiper>
      <!-- æ— æ•°æ®æ—¶æ˜¾ç¤ºå ä½æ–‡æœ¬ -->
      <view class="notice-swiper no-data" wx:else>
        <text class="notice-text">æš‚æ— é€šçŸ¥å…¬å‘Š</text>
      </view>
      <view class="notice-arrow">
        <text class="icon-arrow">></text>
      </view>
    </view>
  </view>

  <!-- è¿å•æŸ¥è¯¢åŒºåŸŸ -->
  <view class="search-section">
    <view class="search-box">
      <!-- æ‰«æå›¾æ ‡ -->
      <view class="scan-icon" bindtap="onScanCode">
        <view class="qr-code-icon">
          <view class="corner corner-tl"></view>
          <view class="corner corner-tr"></view>
          <view class="corner corner-bl"></view>
          <view class="corner corner-br"></view>
        </view>
      </view>
      <!-- è¾“å…¥æ¡† -->
      <input
        class="search-input"
        type="text"
        placeholder="è¯·è¾“å…¥è¿å•å·"
        value="{{waybillCode}}"
        bindinput="onWaybillInput"
      />
      <!-- æ¸…é™¤æŒ‰é’® -->
      <view class="clear-icon" wx:if="{{waybillCode}}" bindtap="onClearInput">
        <view class="clear-icon-inner">
          <text class="icon-clear">Ã—</text>
        </view>
      </view>
      <!-- æŸ¥è¯¢æŒ‰é’® -->
      <view class="search-btn" bindtap="onSearchWaybill">æŸ¥è¯¢</view>
    </view>
  </view>

  <!-- æ ‡ç­¾é¡µå¯¼èˆªå’Œå†…å®¹åŒºåŸŸï¼ˆæ•´ä½“ï¼‰ -->
  <view class="tab-section">
    <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
    <view class="tab-nav">
      <block wx:for="{{tabList}}" wx:key="index">
        <view 
          class="tab-item {{currentTab === index ? 'active' : ''}}"
          data-index="{{index}}"
          bindtap="onTabChange"
        >{{item}}</view>
      </block>
    </view>

    <!-- æ ‡ç­¾é¡µå†…å®¹åŒºåŸŸ -->
    <view class="tab-content">
    <!-- å“ç‰Œç®€ä»‹æ ‡ç­¾é¡µ -->
    <view class="brand-intro-tab" wx:if="{{currentTab === 0}}">
      <!-- å…¬å¸ç®€ä»‹ - ä½¿ç”¨ rich-text è§£æ HTML -->
      <view class="company-desc" wx:if="{{companyInfo && companyInfo.organizationDesc}}">
        <rich-text nodes="{{companyInfo.organizationDesc}}"></rich-text>
      </view>
      
      <!-- ç©ºçŠ¶æ€ -->
      <view class="empty-state" wx:if="{{!companyInfo || !companyInfo.organizationDesc}}">
        <text>æš‚æ— å…¬å¸ä»‹ç»</text>
      </view>
    </view>

    <!-- ç½‘ç‚¹æŸ¥è¯¢æ ‡ç­¾é¡µ -->
    <view class="branch-query-tab" wx:if="{{currentTab === 1}}">
      <!-- æœç´¢æ¡† -->
      <view class="search-box-wrapper">
        <input 
          class="search-input-branch"
          type="text"
          placeholder="è¯·è¾“å…¥ç½‘ç‚¹åç§°æˆ–åœ°å€"
          value="{{searchKeyword}}"
          bindinput="onSearchInput"
        />
        <view 
          class="clear-btn-circle" 
          wx:if="{{searchKeyword}}"
          bindtap="onClearSearch"
        >
          <text class="clear-icon-text">Ã—</text>
        </view>
      </view>
      
      <!-- ç½‘ç‚¹åˆ—è¡¨ -->
      <view class="branch-list">
        <block wx:for="{{filteredBranches}}" wx:key="id">
          <view class="branch-item">
            <!-- ç½‘ç‚¹åç§° -->
            <view class="branch-row">
              <text class="branch-label">ç½‘ç‚¹åç§°ï¼š</text>
              <text class="branch-value">{{item.branchName}}</text>
            </view>
            
            <!-- è”ç³»ç”µè¯ -->
            <view class="branch-row" bindtap="onCallPhone" data-phone="{{item.branchMobile}}">
              <text class="branch-label">è”ç³»ç”µè¯ï¼š</text>
              <text class="branch-value">{{item.branchMobile}}</text>
              <text class="branch-icon">ğŸ“</text>
            </view>
            
            <!-- ç½‘ç‚¹åœ°å€ -->
            <view class="branch-row" bindtap="onOpenLocation" data-branch="{{item}}">
              <text class="branch-label">ç½‘ç‚¹åœ°å€ï¼š</text>
              <text class="branch-value">{{item.branchAddress}}</text>
              <text class="branch-icon">ğŸ“</text>
            </view>
          </view>
        </block>
        
        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state" wx:if="{{filteredBranches.length === 0}}">
          <text>æš‚æ— åŒ¹é…çš„ç½‘ç‚¹</text>
        </view>
      </view>
    </view>

    <!-- çº¿è·¯æŸ¥è¯¢æ ‡ç­¾é¡µ -->
    <view class="route-query-tab" wx:if="{{currentTab === 2}}">
      <!-- æœç´¢æ¡†åŒºåŸŸ -->
      <view class="search-section-route">
        <!-- å§‹å‘åŸé•‡è¾“å…¥æ¡† -->
        <view class="search-box-route">
          <input 
            class="search-input-route"
            type="text"
            placeholder="å§‹å‘åŸé•‡"
            value="{{loadCity}}"
            bindinput="onLoadCityInput"
            bindfocus="onLoadCityFocus"
            bindblur="onLoadCityBlur"
          />
          <view 
            class="clear-btn-route" 
            wx:if="{{loadCity}}"
            bindtap="onClearLoadCity"
          >
            <text class="clear-icon-route">Ã—</text>
          </view>
          <!-- åŸé•‡é€‰æ‹©ä¸‹æ‹‰åˆ—è¡¨ -->
          <view class="city-dropdown" wx:if="{{showLoadCityDropdown && filteredLoadCities.length > 0}}">
            <block wx:for="{{filteredLoadCities}}" wx:key="index">
              <view class="city-item" bindtap="onSelectLoadCity" data-city="{{item}}">
                {{item}}
              </view>
            </block>
          </view>
        </view>
        
        <!-- ç®­å¤´å›¾æ ‡ -->
        <view class="arrow-icon-wrapper">
          <text class="arrow-icon">â†’</text>
        </view>
        
        <!-- åˆ°è¾¾åŸé•‡è¾“å…¥æ¡† -->
        <view class="search-box-route">
          <input 
            class="search-input-route"
            type="text"
            placeholder="åˆ°è¾¾åŸé•‡"
            value="{{discCity}}"
            bindinput="onDiscCityInput"
            bindfocus="onDiscCityFocus"
            bindblur="onDiscCityBlur"
          />
          <view 
            class="clear-btn-route" 
            wx:if="{{discCity}}"
            bindtap="onClearDiscCity"
          >
            <text class="clear-icon-route">Ã—</text>
          </view>
          <!-- åŸé•‡é€‰æ‹©ä¸‹æ‹‰åˆ—è¡¨ -->
          <view class="city-dropdown" wx:if="{{showDiscCityDropdown && filteredDiscCities.length > 0}}">
            <block wx:for="{{filteredDiscCities}}" wx:key="index">
              <view class="city-item" bindtap="onSelectDiscCity" data-city="{{item}}">
                {{item}}
              </view>
            </block>
          </view>
        </view>
      </view>
      
      <!-- çº¿è·¯åˆ—è¡¨ -->
      <view class="route-list">
        <block wx:for="{{filteredRoutes}}" wx:key="id">
          <view class="route-item">
            <!-- çº¿è·¯è·¯ç”± -->
            <view class="route-row route-header-row">
              <text class="route-label">çº¿è·¯è·¯ç”±ï¼š</text>
              <text class="route-value route-name">{{item.branchRouteName}}</text>
            </view>
            <view class="route-divider"></view>
            
            <!-- å§‹å‘ç½‘ç‚¹ -->
            <view class="route-row">
              <text class="route-label">å§‹å‘ç½‘ç‚¹ï¼š</text>
              <view class="route-info-wrapper" wx:if="{{item.loadBranch}}">
                <view class="route-info-main">
                  <text class="route-branch-name">{{item.loadBranch.branchName}}</text>
                  <text class="route-branch-phone">{{item.loadBranch.branchMobile || item.loadBranch.branchPhone}}</text>
                </view>
                <view class="route-info-address">{{item.loadBranch.branchAddress}}</view>
              </view>
              <view class="route-action-icon" bindtap="onCallPhone" data-phone="{{item.loadBranch.branchMobile || item.loadBranch.branchPhone}}" wx:if="{{item.loadBranch}}">
                <text class="phone-icon">ğŸ“</text>
              </view>
            </view>
            <view class="route-divider"></view>
            
            <!-- åˆ°è¾¾ç½‘ç‚¹ -->
            <view class="route-row">
              <text class="route-label">åˆ°è¾¾ç½‘ç‚¹ï¼š</text>
              <view class="route-info-wrapper" wx:if="{{item.discBranch}}">
                <view class="route-info-main">
                  <text class="route-branch-name">{{item.discBranch.branchName}}</text>
                  <text class="route-branch-phone">{{item.discBranch.branchMobile || item.discBranch.branchPhone}}</text>
                </view>
                <view class="route-info-address">{{item.discBranch.branchAddress}}</view>
              </view>
              <view class="route-action-icon" bindtap="onCallPhone" data-phone="{{item.discBranch.branchMobile || item.discBranch.branchPhone}}" wx:if="{{item.discBranch}}">
                <text class="phone-icon">ğŸ“</text>
              </view>
            </view>
            <view class="route-divider"></view>
            
            <!-- çº¿è·¯æ—¶æ•ˆ -->
            <view class="route-row">
              <text class="route-label">çº¿è·¯æ—¶æ•ˆï¼š</text>
              <text class="route-value">{{item.lineTypeLabel}}{{item.lineValidityLabel}}</text>
            </view>
            <view class="route-divider"></view>
            
            <!-- çº¿è·¯ä»·æ ¼ -->
            <view class="route-row">
              <text class="route-label">çº¿è·¯ä»·æ ¼ï¼š</text>
              <text class="route-value"></text>
            </view>
            <view class="route-divider"></view>
            
            <!-- å¢å€¼æœåŠ¡ -->
            <view class="route-row">
              <text class="route-label">å¢å€¼æœåŠ¡ï¼š</text>
              <text class="route-value">{{item.routeServicesLabel}}</text>
            </view>
          </view>
        </block>
        
        <!-- ç©ºçŠ¶æ€ -->
        <view class="empty-state" wx:if="{{filteredRoutes.length === 0}}">
          <text>æš‚æ— åŒ¹é…çš„çº¿è·¯</text>
        </view>
      </view>
    </view>

    <!-- è”ç³»æˆ‘ä»¬æ ‡ç­¾é¡µ -->
    <view class="contact-tab" wx:if="{{currentTab === 3 && companyInfo}}">
      <view class="contact-card">
        <!-- æ€»éƒ¨åœ°å€ -->
        <view class="contact-item" wx:if="{{companyInfo.address}}">
          <text class="contact-label-fixed">æ€»éƒ¨åœ°å€ï¼š</text>
          <text class="contact-value-flex">{{companyInfo.address}}</text>
          <view class="contact-icon-wrapper" bindtap="onOpenCompanyMap">
            <text class="contact-icon-emoji">ğŸ“</text>
          </view>
        </view>
        <view class="contact-divider" wx:if="{{companyInfo.address}}"></view>
        
        <!-- è”ç³»äºº -->
        <view class="contact-item" wx:if="{{companyInfo.principalName}}">
          <text class="contact-label-fixed">è” ç³» äººï¼š</text>
          <text class="contact-value-flex">{{companyInfo.principalName}}</text>
        </view>
        <view class="contact-divider" wx:if="{{companyInfo.principalName}}"></view>
        
        <!-- å®¢æœç”µè¯ -->
        <view class="contact-item" wx:if="{{companyInfo.organizationPhone}}">
          <text class="contact-label-fixed">å®¢æœç”µè¯ï¼š</text>
          <text class="contact-value-flex">{{companyInfo.organizationPhone}}</text>
          <view class="contact-icon-wrapper" bindtap="onCallPhone" data-phone="{{companyInfo.organizationPhone}}">
            <text class="contact-icon-emoji">ğŸ“</text>
          </view>
        </view>
        <view class="contact-divider" wx:if="{{companyInfo.organizationPhone}}"></view>
        
        <!-- ä¸šåŠ¡ç»ç† -->
        <view class="contact-item" wx:if="{{companyInfo.principalPhone}}">
          <text class="contact-label-fixed">ä¸šåŠ¡ç»ç†ï¼š</text>
          <text class="contact-value-flex">{{companyInfo.principalPhone}}</text>
          <view class="contact-icon-wrapper" bindtap="onCallPhone" data-phone="{{companyInfo.principalPhone}}">
            <text class="contact-icon-emoji">ğŸ“</text>
          </view>
        </view>
        <view class="contact-divider" wx:if="{{companyInfo.principalPhone}}"></view>
        
        <!-- å’¨è¯¢ç”µè¯ -->
        <view class="contact-item" wx:if="{{companyInfo.corporationPhone}}">
          <text class="contact-label-fixed">å’¨è¯¢ç”µè¯ï¼š</text>
          <text class="contact-value-flex">{{companyInfo.corporationPhone}}</text>
          <view class="contact-icon-wrapper" bindtap="onCallPhone" data-phone="{{companyInfo.corporationPhone}}">
            <text class="contact-icon-emoji">ğŸ“</text>
          </view>
        </view>
        <view class="contact-divider" wx:if="{{companyInfo.corporationPhone}}"></view>
        
        <!-- å…¬å¸ç½‘å€ -->
        <view class="contact-item" wx:if="{{companyInfo.organizationUrl}}">
          <text class="contact-label-fixed">å…¬å¸ç½‘å€ï¼š</text>
          <text class="contact-value-flex url">{{companyInfo.organizationUrl}}</text>
          <view class="contact-icon-wrapper" bindtap="onCopyUrl">
            <text class="contact-icon-emoji">ğŸŒ</text>
          </view>
        </view>
      </view>
    </view>
  </view>
  </view>
</view>